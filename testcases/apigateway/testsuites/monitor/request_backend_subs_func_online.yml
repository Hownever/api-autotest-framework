- config:
    name: 创建分组-创建订阅密钥访问授权-签名后请求后端func-成功
    base_url: ${ENV(ENV_BASE_URL)}
    variables:
        product: ${ENV(ENV_PRODUCT)}
        apiVersion: ${ENV(ENV_API_VERSION)}
        openapi_yaml: ${ENV(ENV_OPENAPI_SWAGGER_FILE_PATH)}
        regionId: ${ENV(ENV_DEFAULT_REGIONID)}
        api_ver: ${ENV(ENV_API_VERSION)}
        pin: ${ENV(ENV_PIN)}
        AK: ${ENV(ENV_AK)}
        SK: ${ENV(ENV_SK)}
    verify: False
    output:
        - apiGroupId
        - revision

- test:
    name: 创建分组-创建订阅密钥访问授权-成功
    testcase: testcases/monitor/createAccessAuth_subs_func_online.yml
    output:
        - apiGroupId
        - revision
        - environment
        - subscriptionKeys
        - authUserType
        - subsName

- test:
    name: 请求createTaskJson接口
    api: api/monitor/requestBackend/createTaskJson.yml
    variables:
        subscriptionKey: ${get_id_from_list($subscriptionKeys, name, $subsName, subscriptionKey)}
        gw_host: ${return_string($apiGroupId, env=$environment, host=1, regionId=$regionId)}
        description: description
        title: title
        USERAK: USERAK
        USERSK: USERSK
    extract:
        - scode: status_code
    validate:
        - eq: [$scode, 200]