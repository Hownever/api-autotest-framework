- config:
    name: back_wrong_childpin_describeInstanceTypes.yml
    variables:
        - regionId: ${ENV(regionId)}
        - no_exist_child_pin: ${ENV(no_exist_child_pin)}
        - openapiGwUrl: ${ENV(openapiGwUrl)}
        - domain: ${ENV(domain)}
        - access_key_back: ${ENV(access_key_back)}
        - secret_key_back: ${ENV(secret_key_back)}

- test:
    name: 控制台aksk，传不存在的子账户pin，调用外部接口describeInstanceTypes，调用成功
    request:
        url: /v1/regions/$regionId/instanceTypes
        method: GET
        headers:
            Content-Type: application/json
            x-jdcloud-pin: $no_exist_child_pin
        params: ~
    setup_hooks:
        - ${update_JD_headers($request, $openapiGwUrl, None, vm, $access_key_back, $secret_key_back, $regionId)}
    extract:
        - scode: status_code
        - requestId: content.requestId
    validate:
        - eq: [$scode, 200]
        - len_eq: [$requestId, 32]
